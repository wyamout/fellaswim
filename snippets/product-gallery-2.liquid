{%- assign product_types = '' -%}

{%- if types == true -%}
  {%- for product in products -%}
    {%- unless forloop.first -%}
      {%- assign product_types = product_types | append: '|' -%}
    {%- endunless -%}
    {%- assign product_types = product_types | append: product.type -%}
  {%- endfor -%}

  {%- assign product_types = product_types | split: '|' | uniq -%}

{%- elsif types != blank -%}
  {%- assign product_types = types | split: ',' -%}
{%- endif -%}

<div class="product-gallery">
  {% if types != blank %}
    <div class="product-gallery--filters">
      {% if product_types != '' %}
        {%- for type in product_types -%}
          {%- assign type_handle = type | handleize -%}
          {%- assign type_translation = translation | append: type_handle | replace: '-', '_' -%}
          <h3 class="product-gallery--title" data-product-type="{{ type }}" style="font-size: 1.5rem;">
            {{ type_translation | t }}
          </h3>
        {%- endfor -%}
      {%- endif -%}
    </div>
  {% endif %}

  <div class="swiper product-gallery--products">
    <div class="swiper-wrapper">
      {%- for product in products -%}
        <div class="swiper-slide">
          {% render 'product-gallery-item', product: product %}
        </div>
      {%- endfor -%}
    </div>

    <!-- Swiper Navigation -->
    <div class="swiper-button-prev"></div>
    <div class="swiper-button-next"></div>

    <!-- Swiper Pagination -->
    <div class="swiper-pagination"></div>
  </div>
</div>

<!-- Include Swiper (Ensure this is added in your theme if not already included) -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.css">
<script src="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.js"></script>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    new Swiper(".product-gallery--products", {
      slidesPerView: 2,
      spaceBetween: 10,
      navigation: {
        nextEl: ".swiper-button-next",
        prevEl: ".swiper-button-prev",
      },
      pagination: {
        el: ".swiper-pagination",
        clickable: true,
      },
      breakpoints: {
        768: {
          slidesPerView: 2,
        },
        1024: {
          slidesPerView: 2,
        }
      }
    });
  });
</script>
